<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from datetime import datetime
import logging.handlers

<span class="c"># 로거 인스턴스를 만든다</span>
logger <span class="o">=</span> logging.getLogger<span class="o">(</span><span class="s1">'mylogger'</span><span class="o">)</span>

<span class="c"># 포매터를 만든다</span>
fomatter <span class="o">=</span> logging.Formatter<span class="o">(</span><span class="s1">'[%(levelname)s|%(filename)s:%(lineno)s] %(asctime)s \n&gt; %(message)s\n'</span><span class="o">)</span>

udate <span class="o">=</span> str<span class="o">(</span>datetime.utcnow<span class="o">()</span>.strftime<span class="o">(</span><span class="s1">'%Y%m%d%H%M%S'</span><span class="o">))</span>
filename <span class="o">=</span> <span class="s1">'../logs/'</span> + udate + <span class="s1">'.log'</span>

<span class="c"># 환경변수를 읽어서 로깅 레벨과 로그를 남길 파일의 경로를 변수에 저장한다</span>
<span class="c"># if (os.environ['NODE_ENV'] == 'local'):</span>
<span class="c">#     loggerLevel = logging.DEBUG</span>
<span class="c">#     filename = '/tmp/test.log'</span>
<span class="c"># elif(os.environ['NODE_ENV'] == 'test'):</span>
<span class="c">#     loggerLevel = logging.DEBUG</span>
<span class="c">#     filename = '/home/www/log/testServer.log'</span>
<span class="c"># else:</span>
<span class="c">#     loggerLevel = logging.INFO</span>
<span class="c">#     filename = '/home/www/log/server.log'</span>


<span class="c"># 스트림과 파일로 로그를 출력하는 핸들러를 각각 만든다.</span>
<span class="c"># fileHandler = logging.FileHandler(filename)</span>
fileMaxByte <span class="o">=</span> 1024 <span class="k">*</span> 1024 <span class="k">*</span> 100  <span class="c"># 100MB</span>
fileHandler <span class="o">=</span> logging.handlers.RotatingFileHandler<span class="o">(</span>filename, <span class="nv">maxBytes</span><span class="o">=</span>fileMaxByte, <span class="nv">backupCount</span><span class="o">=</span>1000<span class="o">)</span>
streamHandler <span class="o">=</span> logging.StreamHandler<span class="o">()</span>

<span class="c"># 각 핸들러에 포매터를 지정한다.</span>
fileHandler.setFormatter<span class="o">(</span>fomatter<span class="o">)</span>
streamHandler.setFormatter<span class="o">(</span>fomatter<span class="o">)</span>

<span class="c"># 로거 인스턴스에 스트림 핸들러와 파일핸들러를 붙인다.</span>
logger.addHandler<span class="o">(</span>fileHandler<span class="o">)</span>
logger.addHandler<span class="o">(</span>streamHandler<span class="o">)</span>

<span class="c"># 로거 인스턴스로 로그를 찍는다.</span>
logger.setLevel<span class="o">(</span>logging.DEBUG<span class="o">)</span>
logger.debug<span class="o">(</span><span class="s2">"==========================="</span><span class="o">)</span>
logger.info<span class="o">(</span><span class="s2">"TEST START"</span><span class="o">)</span>
logger.warning<span class="o">(</span><span class="s2">"파일 명과 로깅 레벨을 각각 환경마다 다르게 남도록 했어요."</span><span class="o">)</span>
logger.debug<span class="o">(</span><span class="s2">"디버그 로그는 테스트 환경과 로컬 피씨에서남 남는 답니다."</span><span class="o">)</span>
logger.critical<span class="o">(</span><span class="s2">"치명적인 버그는 꼭 파일로 남기기도 하고 메일로 발송하세요!"</span><span class="o">)</span>
logger.debug<span class="o">(</span><span class="s2">"==========================="</span><span class="o">)</span>
logger.info<span class="o">(</span><span class="s2">"TEST END!"</span><span class="o">)</span>

</code></pre></div></div>
